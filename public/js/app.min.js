var application={controllers:{},services:{},config:{}};window.application.config={base:{url:location.origin+"/"},api:{url:location.origin+"/api/v1/"}},function(n){window.application.services.login={signin:function(e){return fetch(n.api.url+"signin",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"},credentials:"same-origin"})},signup:function(e){return fetch(n.api.url+"signup",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"},credentials:"same-origin"})}}}(application.config),function(t,n){var i=document.querySelector("#js-sign-in");if(i){var r=i.querySelector("form");r.onsubmit=function(e){e.preventDefault(),n.signin({username:r.querySelector("input[name=email]").value,password:r.querySelector("input[name=password]").value}).then(function(e){return e.json()}).then(function(e){if(e.success)$("#js-message-success").dimmer("show"),setTimeout(function(){$("#js-message-success").dimmer("hide"),location=t.base.url},3e3);else{$("#js-message-errors").dimmer("show");var n="<ul>";e.errors.map(function(e){n+="<li>"+e+"</li>"}),n+="</ul>",i.querySelector("#js-message-errors").querySelector(".sub.header").innerHTML=n}})}}}(application.config,application.services.login),function(t,n){var i=document.querySelector("#js-sign-up");if(i){var e=i.querySelector("form"),r=i.querySelector("input[name=username]"),s=i.querySelector("input[name=email]"),a=i.querySelector("input[name=phone]"),o=i.querySelector("input[name=password]"),u=i.querySelector("input[name=password-repeat]"),l=i.querySelector("button[type=submit]"),c={username:"",email:"",phone:"",password:"",passwordRepeat:""};$("input[name=phone]").mask("(000) 000-00-00"),l.disabled=!0;var p=function(){0<m.length?l.disabled=!0:l.disabled=!1},m=["username","email","password","password-repeat"],d=function(n){var e=i.querySelector("input[name="+n+"]");e&&e.nextElementSibling.classList.add("hidden"),m.forEach(function(e){e===n&&m.splice(m.indexOf(n),1)})},f=function(n){var e=i.querySelector("input[name="+n+"]");(e=i.querySelector("input[name="+n+"]"))&&e.nextElementSibling.classList.remove("hidden"),m.forEach(function(e){e===n&&m.splice(m.indexOf(n),1)}),m.push(n)};r.oninput=function(e){e.preventDefault();var n=e.target.value;0<n.length?d("username"):f("username"),c.username=n,p()},s.oninput=function(e){e.preventDefault();var n=e.target.value;e.target.nextElementSibling;/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())?d("email"):f("email"),c.email=n,p()},a.oninput=function(e){e.preventDefault();var n=e.target.value;if(0<n.length){var t=parseInt(n,10);isNaN(t)||10!==n.length?f("phone"):d("phone")}else d("phone");c.phone=n,p()},o.addEventListener("input",function(e){e.preventDefault();e.target.nextElementSibling;var n=e.target.value;n.length<8?f("password"):d("password"),n!==c.passwordRepeat?f("password-repeat"):d("password-repeat"),c.password=n,p()}),u.addEventListener("input",function(e){e.preventDefault();e.target.nextElementSibling;var n=e.target.value;n!==c.password?f("password-repeat"):d("password-repeat"),c.passwordRepeat=n,p()}),e.onsubmit=function(e){e.preventDefault(),l.disabled=!0,n.signup(c).then(function(e){return e.json()}).then(function(e){if(e.success)$("#js-message-success").dimmer("show"),setTimeout(function(){$("#js-message-success").dimmer("hide"),location=t.base.url+"signin"},3e3);else{l.disabled=!1,$("#js-message-errors").dimmer("show");var n="<ul>";e.errors.map(function(e){n+="<li>"+e+"</li>"}),n+="</ul>",i.querySelector("#js-message-errors").querySelector(".sub.header").innerHTML=n}}).catch(function(e){l.disabled=!1,$("#js-message-error").dimmer("show")})}}}(application.config,application.services.login);